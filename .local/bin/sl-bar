#!/bin/sh

delim=" | "

delimiter() {
	dl="$delim"
	printf "%s" "$dl"
}

datetime() {
	date=$(date +'%Y %b %d %a %I:%M %p %Z')
	printf "%s" "$date"
}

memory() {
	mem_used=$(free -h | awk '/^Mem:/ {print $3 " / " $2}')
	printf "%s" "$mem_used"
}

volume() {
	vol=$(wpctl get-volume @DEFAULT_AUDIO_SINK@)
	vol="${vol#Volume: }"

	printf "vol: %s" "$vol"
}

battery() {
	dir="/sys/class/power_supply/BAT0"
	bat=$(cat $dir/capacity)
	status=$(cat $dir/status)
	case "$status" in
		"Discharging") stat='z' ;;
		"Charging") stat='+' ;;
		"Full") stat='@' ;;
		*) stat='x' ;;
	esac
	printf "%s%% %s" "$bat" "$stat"
}

status() {
	# Place modules here in order.
	volume
	delimiter
	memory
	delimiter
	battery
	delimiter
	datetime
}

while true; do
	xsetroot -name " $(status) "
	sleep 30
done
