#!/bin/sh

# This is a rewritten script for the battery module.

# Basic variables for battery module
dir="/sys/class/power_supply/BAT0"
bat=$(cat $dir/capacity)
stat=$(cat $dir/status)

# Provide a warning symbol for low power and proper notifications for promptness
[ $stat = "Discharging" ] && [ $bat -le 10 ] && [ $bat -gt 5 ] && warn="❗" && \
	notify-send "⚠️ Battery level is low." "Please charge your device soon."
[ $stat = "Discharging" ] && [ $bat -le 5 ] && warn="❗" && \
	notify-send -u critical "⚠️ Battery level is dangerously low." "Charge your device ASAP."

# Notify when clicked via the right mouse button
case $BUTTON in
        3) notify-send "⚡ Battery module" "Displays battery status.
- 🔌 charging
- ⚡ fully-charged
- ♻️ stagnant
- 🔋 discharging
- ❗ low battery (please charge!)" ;;
        5) $TERMINAL -e $EDITOR "$0" ;;
esac

# Main function that replaces text with appropriate symbols
printf "%s%s%s\n" "$(echo $stat | sed 's/Discharging/🔋/;s/Charging/🔌/;s/Full/⚡/;s/Not charging/♻️/')" "$warn" "$(echo $bat | sed 's/$/%/')"
