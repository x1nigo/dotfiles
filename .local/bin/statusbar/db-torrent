#!/bin/sh

# TODO: Find a way to add torrents as the user clicks upon the download link.
# To add a torrent, open your terminal and type transmission-remote -a "<insert link>".

case $BUTTON in
	1) setsid -f ${TERMINAL:-st} -e tremc ;;
        3) notify-send "🌑🌱 Torrent module" "Click to see all your torrents.
- 🛑 paused
- 🕰️ idle
- ⬆️ uploading
- ⬇️ downloading
- ✅ done
- 🌱 seeding" ;;
        5) $TERMINAL -e $EDITOR "$0" ;;
esac

# Display default icon if no torrent is active.
active="$(transmission-remote -l | grep %)"
[ -z "$active" ] && exit 0

# Show the proper icon depending on status of the torrent/s.
transmission-remote -l | grep % |
	sed " # The letters are for sorting and will not appear.
	s/.*Stopped.*/A 🛑/;
	s/.*Seeding.*/Z 🌱/;
	s/.*100%.*/N ✅/;
	s/.*Idle.*/B 🕰️/;
	s/.*Uploading.*/L ⬆️/;
	s/.*%.*/M ⬇️/" |
		sort -h | uniq -c | awk '{print $3 $1}' | paste -sd ' ' -
