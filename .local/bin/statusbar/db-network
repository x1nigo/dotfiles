#! /bin/sh

# Display the following:
# ðŸ“¶: wifi running w/ strength
# ðŸ“¡: no wifi connection
# ðŸŒ: connected to ethernet
# âŽ: no ethernet connection

if grep -xq 'up' /sys/class/net/wl*/operstate 2>/dev/null; then
	wlicon="$(awk '/wl/ {print "ðŸ“¶", int($3 * 100 / 70) }' /proc/net/wireless)% "
elif grep -xq 'down' /sys/class/net/wl*/operstate 2>/dev/null; then
	grep -xq '0x1003' /sys/class/net/wl*/flags && wlicon="ðŸ“¡" || wlicon="âŒ"
fi

case $BUTTON in
        1) st -e nmtui ;;
        3) active=$(nmcli -t -f name connection show --active)
                if [ -z $active ]; then
                        notify-send "ðŸ§­ Network module:" "Unable to connect to the internet.

ðŸ“œ Legend:
ðŸ“¶: connected to wifi
ðŸ“¡: no wifi connection
ðŸŒŽ: connected to ethernet
âŽ: no ethernet connection
âŒ: wifi disabled"
                else
                        notify-send "ðŸ§­ Network module:" "Connected to: '$(nmcli -t -f name connection show --active)'

ðŸ“œ Legend:
ðŸ“¶: connected to wifi
ðŸ“¡: no wifi connection
ðŸŒŽ: connected to ethernet
âŽ: no ethernet connection
âŒ: wifi disabled"
                fi ;;
        5) st -e $EDITOR ${XDG_CONFIG_HOME:-$HOME/.config}/dwmblocks/blocks.h ;;
esac

printf "%s%s\n" "$wlicon" "$(sed 's/down/âŽ/;s/up/ðŸŒ/' /sys/class/net/e*/operstate 2>/dev/null)"
