#!/bin/sh

# TODO: Ethernet unoperational. Must find a way to make it work.

if grep -xq 'up' /sys/class/net/wl*/operstate 2>/dev/null; then
	wlicon="$(awk '/wl/ {print "ðŸ“¶", int($3 * 100 / 70) }' /proc/net/wireless)%"
elif grep -xq 'down' /sys/class/net/wl*/operstate 2>/dev/null; then
	grep -xq '0x1003' /sys/class/net/wl*/flags && wlicon="ðŸ“¡" || wlicon="âŒ"
fi

case $BUTTON in
        1) st -e nmtui ;;
        3) notify-send "ðŸŒ Network module:" "\[Click to connect\]
ðŸ“¶ connected to wifi
ðŸ“¡ no wifi connection
ðŸŒ connected to ethernet
âŽ no ethernet connection
âŒ wifi disabled" ;;
        5) st -e $EDITOR ${XDG_CONFIG_HOME:-$HOME/.config}/dwmblocks/blocks.h ;;
esac

printf "%s%s\n" "$wlicon " "$(sed 's/down/âŽ/;s/up/ðŸŒ/' /sys/class/net/e*/operstate 2>/dev/null)"
