#!/bin/sh

# The main file for rendering wallpapers
bgmain="$HOME/.local/share/bg"
# Backgrounds folder
bgdir="$HOME/.local/share/backgrounds"

# Select wallpaper from backgrounds folder
selection() {
	chosen="$(ls "$bgdir" | dmenu -i -l 10 -p "Choose a wallpaper (ESC to cancel):")"
	[ -z "$chosen" ] && exit
	cp "$bgdir/$chosen" $bgmain && \
	notify-send "ðŸŒ… Wallpaper selected!" "$bgdir/$chosen" -i "$bgdir/$chosen" || exit 1
}

remove() {
	xwallpaper --clear && \
	notify-send "ðŸ›‘ Wallpaper cleared!" "Select a new wallpaper [or] execute xsetroot -solid [color]." && exit
}

random() {
	chosen="$(ls "$bgdir" | shuf | head -1)"
	[ -z "$chosen" ] && exit
	cp "$bgdir/$chosen" $bgmain && \
	notify-send "ðŸŽ± Random wallpaper chosen!" "$bgdir/$chosen" -i "$bgdir/$chosen" || exit 1
}

while getopts "srR" z; do
	case ${z} in
		s) selection ;;
		r) remove ;;
		R) random ;;
	esac
done

# If given a file, then use that as wallpaper.
! [ -z "$1" ] && cp "$1" $bgmain
xwallpaper --zoom $bgmain # If no arguments, then just set the previous wallpaper.
