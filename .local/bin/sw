#! /bin/sh

# Setwallpaper script

bglink="${XDG_DATA_HOME:-$HOME/.local/share}/bg"
bgdir="${XDG_DATA_HOME:-$HOME/.local/share}/backgrounds/"

helppls() {
        echo "
setwallpaper            A script by x1nigo to set desktop backgrounds
                        with xwallpaper.
Usage:
        -s              set wallpaper with dmenu
        -a              add image to backgrounds folder
        -h              display this help text
        \`none\`        having no option will simply render the last
                        configured wallpaper
"
}

addbg() {
        [ -z $file ] && notify-send "hello" && exit 1
        cp $file $bgdir
}

selectbg() {
        bgselect="$(ls ${XDG_DATA_HOME:-$HOME/.local/share}/backgrounds | dmenu)"
        if [ -z "$bgselect" ]; then
                exit 0
        else
                type="$(echo -e 'center\nmaximize\nstretch\ntile\nzoom' | dmenu)"
                if [ -z "$type" ]; then
                        exit 0
                else
                        echo $type > /tmp/bgtype
                fi
                ln -sf ${XDG_DATA_HOME:-$HOME/.local/share}/backgrounds/$bgselect $bglink
                xwallpaper --$type "$bglink" && notify-send "üñºÔ∏è \`$bgselect\` set as wallpaper!" "\`$type\` mode selected." && exit
        fi
}

option="$1"
file="$2"
bgtype="$(cat /tmp/bgtype)"
case "$option" in
        -s) selectbg ;;
        -h) helppls ;;
        -a) addbg ;;
esac

xwallpaper --$bgtype "$bglink"
