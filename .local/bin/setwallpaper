#! /bin/sh

bglink="${XDG_DATA_HOME:-$HOME/.local/share}/bg"

helppls() {
        echo "
setwallpaper            A script by x1nigo to set desktop backgrounds
                        with xwallpaper.

Usage:
        -s              set wallpaper with dmenu

        -h              display this help text

        \`none\`        having no option will simply render the last
                        configured wallpaper
"
}

selectbg() {
        bgselect="$(ls ${XDG_DATA_HOME:-$HOME/.local/share}/backgrounds | dmenu)"
        if [ -z "$bgselect" ]; then
                exit 0
        else
                type="$(echo -e 'center\nmaximize\nstretch\ntile\nzoom' | dmenu)"
                if [ -z "$type" ]; then
                        exit 0
                else
                        echo $type > /tmp/bgtype
                fi
                ln -sf ${XDG_DATA_HOME:-$HOME/.local/share}/backgrounds/$bgselect $bglink
                xwallpaper --$type "$bglink" && notify-send -t 6000 "üñºÔ∏è \`$bgselect\` set as wallpaper!" && exit
        fi
}

option="$1"
bgtype="$(cat /tmp/bgtype)"
case "$option" in
        -s) selectbg ;;
        -h) helppls ;;
esac

xwallpaper --$bgtype "$bglink"
